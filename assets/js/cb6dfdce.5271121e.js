"use strict";(self.webpackChunkks_6088_ts_github_io=self.webpackChunkks_6088_ts_github_io||[]).push([[3508],{4493:(e,l,n)=>{n.r(l),n.d(l,{assets:()=>a,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>r,toc:()=>d});var r=n(3257),t=n(4848),s=n(8453);const o={slug:"powershell-get-started",title:"PowerShell \u958b\u767a\u5165\u9580",authors:"ks6088ts",tags:["powershell"]},i=void 0,a={authorsImageUrls:[void 0]},d=[{value:"\u30a8\u30c7\u30a3\u30bf",id:"\u30a8\u30c7\u30a3\u30bf",level:2},{value:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8",id:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8",level:2},{value:"Docker",id:"docker",level:2},{value:"\u30e9\u30a4\u30d6\u30e9\u30ea",id:"\u30e9\u30a4\u30d6\u30e9\u30ea",level:2},{value:"\u30b9\u30cb\u30da\u30c3\u30c8",id:"\u30b9\u30cb\u30da\u30c3\u30c8",level:2},{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",level:3},{value:"PowerShell module \u306e\u4f5c\u6210\u3068\u5229\u7528",id:"powershell-module-\u306e\u4f5c\u6210\u3068\u5229\u7528",level:3},{value:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb",id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb",level:4},{value:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528",id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528",level:4},{value:"\u5b9f\u884c",id:"\u5b9f\u884c",level:4},{value:"\u30c6\u30b9\u30c8",id:"\u30c6\u30b9\u30c8",level:3},{value:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8",id:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8",level:4},{value:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c",id:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c",level:4},{value:"HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c",id:"http-\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c",level:3},{value:"Microsoft Graph API \u306e\u547c\u3073\u51fa\u3057\u4f8b",id:"microsoft-graph-api-\u306e\u547c\u3073\u51fa\u3057\u4f8b",level:4},{value:"\u5b9f\u884c\u4f8b",id:"\u5b9f\u884c\u4f8b",level:4}];function h(e){const l={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.p,{children:"PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u958b\u767a\u5165\u9580\u306b\u4fbf\u5229\u3060\u3068\u601d\u3063\u305f\u30c4\u30fc\u30eb\u3084\u60c5\u5831\u3092\u307e\u3068\u3081\u307e\u3059\u3002"}),"\n",(0,t.jsx)(l.h2,{id:"\u30a8\u30c7\u30a3\u30bf",children:"\u30a8\u30c7\u30a3\u30bf"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.a,{href:"https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell",children:"VS Code extension / PowerShell"}),": Syntax highlighting, intellisense, LSP \u30b5\u30dd\u30fc\u30c8\u306a\u3069\u304c\u3042\u308a\u4fbf\u5229"]}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8",children:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.a,{href:"https://pester.dev/docs/quick-start/",children:"Pester / Quick Start"}),": \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af"]}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"docker",children:"Docker"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.a,{href:"https://mcr.microsoft.com/en-us/product/powershell/about",children:"mcr.microsoft.com/powershell"}),": PowerShell \u306e Docker \u30a4\u30e1\u30fc\u30b8\u3002\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5ec3\u6b62\u306b\u4f34\u3046\u79fb\u884c\u4f5c\u696d\u3084\u30c6\u30b9\u30c8\u306a\u3069\u3001\u9694\u96e2\u3055\u308c\u305f\u74b0\u5883\u3067\u306e\u5b9f\u884c\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u4fbf\u5229"]}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"\u30e9\u30a4\u30d6\u30e9\u30ea",children:"\u30e9\u30a4\u30d6\u30e9\u30ea"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsxs)(l.li,{children:[(0,t.jsx)(l.a,{href:"https://github.com/microsoftgraph/msgraph-sdk-powershell",children:"microsoftgraph/msgraph-sdk-powershell"}),"\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsx)(l.li,{children:"Microsoft Graph API \u3092 PowerShell \u304b\u3089\u53e9\u304f\u3068\u304d\u306b\u4f7f\u3046"}),"\n",(0,t.jsxs)(l.li,{children:["\u53c2\u8003\u30ea\u30f3\u30af","\n",(0,t.jsxs)(l.ul,{children:["\n",(0,t.jsx)(l.li,{children:(0,t.jsx)(l.a,{href:"https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/authentication-commands?view=graph-powershell-1.0",children:"Authentication module cmdlets in Microsoft Graph PowerShell"})}),"\n",(0,t.jsx)(l.li,{children:(0,t.jsx)(l.a,{href:"https://learn.microsoft.com/ja-jp/graph/api/overview?view=graph-rest-1.0",children:"Microsoft Graph REST API v1.0 \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(l.h2,{id:"\u30b9\u30cb\u30da\u30c3\u30c8",children:"\u30b9\u30cb\u30da\u30c3\u30c8"}),"\n",(0,t.jsx)(l.p,{children:"\u3057\u3087\u3063\u3061\u3085\u3046\u6587\u6cd5\u3092\u5fd8\u308c\u3066\u540c\u3058\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3059\u306e\u3067\u3001\u30b9\u30cb\u30da\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002"}),"\n",(0,t.jsx)(l.h3,{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",children:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",metastring:'title="install-modules.ps1"',children:'#!/usr/bin/env pwsh\n\nWrite-Host "Running "$MyInvocation.MyCommand.Name" ..."\n\nSet-PSRepository -Name \'PSGallery\' -InstallationPolicy Trusted\n\n$modules = @(\n    "Microsoft.Graph"\n    "MicrosoftTeams"\n    "Pester"\n)\n\nforeach ($module in $modules) {\n    Write-Host "Installing $module"\n    Install-Module -Name $module -Scope CurrentUser\n}\n'})}),"\n",(0,t.jsx)(l.h3,{id:"powershell-module-\u306e\u4f5c\u6210\u3068\u5229\u7528",children:"PowerShell module \u306e\u4f5c\u6210\u3068\u5229\u7528"}),"\n",(0,t.jsx)(l.h4,{id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb",children:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",metastring:'title="mymodule.psm1"',children:'$global:MyModuleVersion = "v0.0.1"\n\nfunction Get-MyName {\n    return "Hello-World"\n}\n\n# Export variables\nExport-ModuleMember -Variable MyModuleVersion\n\n# Export functions\nExport-ModuleMember -Function Get-MyName\n'})}),"\n",(0,t.jsx)(l.h4,{id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528",children:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",metastring:'title="client.ps1"',children:'using module "./mymodule.psm1"\n\nparam (\n    [parameter(mandatory=$true)][string]$Hello,\n    [parameter(mandatory=$true)][string]$World)\n\n$name = Get-MyName\n\nWrite-Host $name, $MyModuleVersion\nWrite-Host Args: $Hello, $World\n'})}),"\n",(0,t.jsx)(l.h4,{id:"\u5b9f\u884c",children:"\u5b9f\u884c"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",children:"./client.ps1 -Hello Hello -World World\n>>>\nHello-World v0.0.1\nArgs: Hello World\n"})}),"\n",(0,t.jsx)(l.h3,{id:"\u30c6\u30b9\u30c8",children:"\u30c6\u30b9\u30c8"}),"\n",(0,t.jsx)(l.h4,{id:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8",children:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",metastring:'title="mymodule.test.ps1"',children:'using module "./mymodule.psm1"\n\nDescribe "Smoke test" {\n    Context "Nominal case" {\n        It "Check global variables" {\n            # version variable settings\n            $MyModuleVersion | Should Be "v0.0.1"\n        }\n        It "Connect-Helper" {\n            Get-MyName | Should Be "Hello-World"\n        }\n    }\n}\n'})}),"\n",(0,t.jsx)(l.h4,{id:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c",children:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",children:"Invoke-Pester ./mymodule.test.ps1\n>>>\nDescribing Smoke test\n   Context Nominal case\n    [+] Check global variables 495ms\n    [+] Connect-Helper 72ms\nTests completed in 568ms\nPassed: 2 Failed: 0 Skipped: 0 Pending: 0 Inconclusive: 0\n"})}),"\n",(0,t.jsx)(l.h3,{id:"http-\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c",children:"HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c"}),"\n",(0,t.jsx)(l.h4,{id:"microsoft-graph-api-\u306e\u547c\u3073\u51fa\u3057\u4f8b",children:"Microsoft Graph API \u306e\u547c\u3073\u51fa\u3057\u4f8b"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",metastring:'title="httpRequest.ps1"',children:'param (\n    [parameter(mandatory=$true)][string]$TenantId,\n    [parameter(mandatory=$true)][string]$ClientId,\n    [parameter(mandatory=$true)][string]$ClientSecret,\n    [parameter(mandatory=$true)][string]$Csv)\n\n# -- Token \u3092\u53d6\u5f97\u3059\u308b --\n$token = Invoke-RestMethod -Method Post -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" -Body @{client_id="$clientId";scope="https://graph.microsoft.com/.default";client_secret="$clientSecret";grant_type="client_credentials"} -ContentType \'application/x-www-form-urlencoded\'\n$accessToken = $token.access_token\n'})}),"\n",(0,t.jsx)(l.h4,{id:"\u5b9f\u884c\u4f8b",children:"\u5b9f\u884c\u4f8b"}),"\n",(0,t.jsx)(l.pre,{children:(0,t.jsx)(l.code,{className:"language-powershell",children:"./httpRequest.ps1 -TenantId 789 -ClientId 566 -ClientSecret 444 \n"})})]})}function c(e={}){const{wrapper:l}={...(0,s.R)(),...e.components};return l?(0,t.jsx)(l,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,l,n)=>{n.d(l,{R:()=>o,x:()=>i});var r=n(6540);const t={},s=r.createContext(t);function o(e){const l=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(l):{...l,...e}}),[l,e])}function i(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),r.createElement(s.Provider,{value:l},e.children)}},3257:e=>{e.exports=JSON.parse('{"permalink":"/blog/powershell-get-started","source":"@site/blog/2023-03-24-powershell-get-started.md","title":"PowerShell \u958b\u767a\u5165\u9580","description":"PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u958b\u767a\u5165\u9580\u306b\u4fbf\u5229\u3060\u3068\u601d\u3063\u305f\u30c4\u30fc\u30eb\u3084\u60c5\u5831\u3092\u307e\u3068\u3081\u307e\u3059\u3002","date":"2023-03-24T00:00:00.000Z","tags":[{"inline":true,"label":"powershell","permalink":"/blog/tags/powershell"}],"readingTime":2.115,"hasTruncateMarker":true,"authors":[{"name":"ks6088ts","title":"Software Engineer / Solutions Architect","url":"https://github.com/ks6088ts","imageURL":"https://github.com/ks6088ts.png","key":"ks6088ts","page":null}],"frontMatter":{"slug":"powershell-get-started","title":"PowerShell \u958b\u767a\u5165\u9580","authors":"ks6088ts","tags":["powershell"]},"unlisted":false,"prevItem":{"title":"Building a ChatGPT trial environment using Azure OpenAI Service","permalink":"/blog/fork-azure-openai-playground-en"},"nextItem":{"title":"Azure IoT Edge \u3092\u7528\u3044\u305f\u30cf\u30f3\u30ba\u30aa\u30f3","permalink":"/blog/handson-iot-edge"}}')}}]);
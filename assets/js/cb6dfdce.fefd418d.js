"use strict";(self.webpackChunkks_6088_ts_github_io=self.webpackChunkks_6088_ts_github_io||[]).push([[4736],{3905:(e,t,l)=>{l.d(t,{Zo:()=>m,kt:()=>h});var r=l(7294);function n(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function o(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,r)}return l}function a(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?o(Object(l),!0).forEach((function(t){n(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):o(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function s(e,t){if(null==e)return{};var l,r,n=function(e,t){if(null==e)return{};var l,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)l=o[r],t.indexOf(l)>=0||(n[l]=e[l]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)l=o[r],t.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(n[l]=e[l])}return n}var i=r.createContext({}),p=function(e){var t=r.useContext(i),l=t;return e&&(l="function"==typeof e?e(t):a(a({},t),e)),l},m=function(e){var t=p(e.components);return r.createElement(i.Provider,{value:t},e.children)},u="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var l=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),u=p(l),d=n,h=u["".concat(i,".").concat(d)]||u[d]||c[d]||o;return l?r.createElement(h,a(a({ref:t},m),{},{components:l})):r.createElement(h,a({ref:t},m))}));function h(e,t){var l=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=l.length,a=new Array(o);a[0]=d;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[u]="string"==typeof e?e:n,a[1]=s;for(var p=2;p<o;p++)a[p]=l[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,l)}d.displayName="MDXCreateElement"},8021:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>i,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=l(7462),n=(l(7294),l(3905));const o={slug:"powershell-get-started",title:"PowerShell \u958b\u767a\u5165\u9580",authors:"ks6088ts",tags:["powershell"]},a=void 0,s={permalink:"/blog/powershell-get-started",source:"@site/blog/2023-03-24-powershell-get-started.md",title:"PowerShell \u958b\u767a\u5165\u9580",description:"PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u958b\u767a\u5165\u9580\u306b\u4fbf\u5229\u3060\u3068\u601d\u3063\u305f\u30c4\u30fc\u30eb\u3084\u60c5\u5831\u3092\u307e\u3068\u3081\u307e\u3059\u3002",date:"2023-03-24T00:00:00.000Z",formattedDate:"2023\u5e743\u670824\u65e5",tags:[{label:"powershell",permalink:"/blog/tags/powershell"}],readingTime:2.115,hasTruncateMarker:!0,authors:[{name:"ks6088ts",title:"Software Engineer / Solutions Architect",url:"https://github.com/ks6088ts",imageURL:"https://github.com/ks6088ts.png",key:"ks6088ts"}],frontMatter:{slug:"powershell-get-started",title:"PowerShell \u958b\u767a\u5165\u9580",authors:"ks6088ts",tags:["powershell"]},nextItem:{title:"Azure IoT Edge \u3092\u7528\u3044\u305f\u30cf\u30f3\u30ba\u30aa\u30f3",permalink:"/blog/handson-iot-edge"}},i={authorsImageUrls:[void 0]},p=[{value:"\u30a8\u30c7\u30a3\u30bf",id:"\u30a8\u30c7\u30a3\u30bf",level:2},{value:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8",id:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8",level:2},{value:"Docker",id:"docker",level:2},{value:"\u30e9\u30a4\u30d6\u30e9\u30ea",id:"\u30e9\u30a4\u30d6\u30e9\u30ea",level:2},{value:"\u30b9\u30cb\u30da\u30c3\u30c8",id:"\u30b9\u30cb\u30da\u30c3\u30c8",level:2},{value:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb",level:3},{value:"PowerShell module \u306e\u4f5c\u6210\u3068\u5229\u7528",id:"powershell-module-\u306e\u4f5c\u6210\u3068\u5229\u7528",level:3},{value:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb",id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb",level:4},{value:"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528",id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528",level:4},{value:"\u5b9f\u884c",id:"\u5b9f\u884c",level:4},{value:"\u30c6\u30b9\u30c8",id:"\u30c6\u30b9\u30c8",level:3},{value:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8",id:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8",level:4},{value:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c",id:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c",level:4},{value:"HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c",id:"http-\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c",level:3},{value:"Microsoft Graph API \u306e\u547c\u3073\u51fa\u3057\u4f8b",id:"microsoft-graph-api-\u306e\u547c\u3073\u51fa\u3057\u4f8b",level:4},{value:"\u5b9f\u884c\u4f8b",id:"\u5b9f\u884c\u4f8b",level:4}],m={toc:p},u="wrapper";function c(e){let{components:t,...l}=e;return(0,n.kt)(u,(0,r.Z)({},m,l,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"PowerShell \u30b9\u30af\u30ea\u30d7\u30c8\u306e\u958b\u767a\u5165\u9580\u306b\u4fbf\u5229\u3060\u3068\u601d\u3063\u305f\u30c4\u30fc\u30eb\u3084\u60c5\u5831\u3092\u307e\u3068\u3081\u307e\u3059\u3002"),(0,n.kt)("h2",{id:"\u30a8\u30c7\u30a3\u30bf"},"\u30a8\u30c7\u30a3\u30bf"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://marketplace.visualstudio.com/items?itemName=ms-vscode.PowerShell"},"VS Code extension / PowerShell"),": Syntax highlighting, intellisense, LSP \u30b5\u30dd\u30fc\u30c8\u306a\u3069\u304c\u3042\u308a\u4fbf\u5229")),(0,n.kt)("h2",{id:"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8"},"\u30e6\u30cb\u30c3\u30c8\u30c6\u30b9\u30c8"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://pester.dev/docs/quick-start/"},"Pester / Quick Start"),": \u30c6\u30b9\u30c8\u30d5\u30ec\u30fc\u30e0\u30ef\u30fc\u30af")),(0,n.kt)("h2",{id:"docker"},"Docker"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://mcr.microsoft.com/en-us/product/powershell/about"},"mcr.microsoft.com/powershell"),": PowerShell \u306e Docker \u30a4\u30e1\u30fc\u30b8\u3002\u30e9\u30a4\u30d6\u30e9\u30ea\u306e\u5ec3\u6b62\u306b\u4f34\u3046\u79fb\u884c\u4f5c\u696d\u3084\u30c6\u30b9\u30c8\u306a\u3069\u3001\u9694\u96e2\u3055\u308c\u305f\u74b0\u5883\u3067\u306e\u5b9f\u884c\u304c\u5fc5\u8981\u306a\u5834\u5408\u306b\u4fbf\u5229")),(0,n.kt)("h2",{id:"\u30e9\u30a4\u30d6\u30e9\u30ea"},"\u30e9\u30a4\u30d6\u30e9\u30ea"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://github.com/microsoftgraph/msgraph-sdk-powershell"},"microsoftgraph/msgraph-sdk-powershell"),(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Microsoft Graph API \u3092 PowerShell \u304b\u3089\u53e9\u304f\u3068\u304d\u306b\u4f7f\u3046"),(0,n.kt)("li",{parentName:"ul"},"\u53c2\u8003\u30ea\u30f3\u30af",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/ja-jp/powershell/microsoftgraph/authentication-commands?view=graph-powershell-1.0"},"Authentication module cmdlets in Microsoft Graph PowerShell")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/ja-jp/graph/api/overview?view=graph-rest-1.0"},"Microsoft Graph REST API v1.0 \u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8 \u30ea\u30d5\u30a1\u30ec\u30f3\u30b9"))))))),(0,n.kt)("h2",{id:"\u30b9\u30cb\u30da\u30c3\u30c8"},"\u30b9\u30cb\u30da\u30c3\u30c8"),(0,n.kt)("p",null,"\u3057\u3087\u3063\u3061\u3085\u3046\u6587\u6cd5\u3092\u5fd8\u308c\u3066\u540c\u3058\u3053\u3068\u3092\u7e70\u308a\u8fd4\u3059\u306e\u3067\u3001\u30b9\u30cb\u30da\u30c3\u30c8\u3092\u4f5c\u6210\u3057\u3066\u304a\u304f\u3002"),(0,n.kt)("h3",{id:"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb"},"\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u4e00\u62ec\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="install-modules.ps1"',title:'"install-modules.ps1"'},'#!/usr/bin/env pwsh\n\nWrite-Host "Running "$MyInvocation.MyCommand.Name" ..."\n\nSet-PSRepository -Name \'PSGallery\' -InstallationPolicy Trusted\n\n$modules = @(\n    "Microsoft.Graph"\n    "MicrosoftTeams"\n    "Pester"\n)\n\nforeach ($module in $modules) {\n    Write-Host "Installing $module"\n    Install-Module -Name $module -Scope CurrentUser\n}\n')),(0,n.kt)("h3",{id:"powershell-module-\u306e\u4f5c\u6210\u3068\u5229\u7528"},"PowerShell module \u306e\u4f5c\u6210\u3068\u5229\u7528"),(0,n.kt)("h4",{id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb"},"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="mymodule.psm1"',title:'"mymodule.psm1"'},'$global:MyModuleVersion = "v0.0.1"\n\nfunction Get-MyName {\n    return "Hello-World"\n}\n\n# Export variables\nExport-ModuleMember -Variable MyModuleVersion\n\n# Export functions\nExport-ModuleMember -Function Get-MyName\n')),(0,n.kt)("h4",{id:"powershell-\u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528"},"PowerShell \u30e2\u30b8\u30e5\u30fc\u30eb\u306e\u5229\u7528"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="client.ps1"',title:'"client.ps1"'},'using module "./mymodule.psm1"\n\nparam (\n    [parameter(mandatory=$true)][string]$Hello,\n    [parameter(mandatory=$true)][string]$World)\n\n$name = Get-MyName\n\nWrite-Host $name, $MyModuleVersion\nWrite-Host Args: $Hello, $World\n')),(0,n.kt)("h4",{id:"\u5b9f\u884c"},"\u5b9f\u884c"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},"./client.ps1 -Hello Hello -World World\n>>>\nHello-World v0.0.1\nArgs: Hello World\n")),(0,n.kt)("h3",{id:"\u30c6\u30b9\u30c8"},"\u30c6\u30b9\u30c8"),(0,n.kt)("h4",{id:"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8"},"\u30c6\u30b9\u30c8\u30b9\u30af\u30ea\u30d7\u30c8"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="mymodule.test.ps1"',title:'"mymodule.test.ps1"'},'using module "./mymodule.psm1"\n\nDescribe "Smoke test" {\n    Context "Nominal case" {\n        It "Check global variables" {\n            # version variable settings\n            $MyModuleVersion | Should Be "v0.0.1"\n        }\n        It "Connect-Helper" {\n            Get-MyName | Should Be "Hello-World"\n        }\n    }\n}\n')),(0,n.kt)("h4",{id:"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c"},"\u30c6\u30b9\u30c8\u306e\u5b9f\u884c"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},"Invoke-Pester ./mymodule.test.ps1\n>>>\nDescribing Smoke test\n   Context Nominal case\n    [+] Check global variables 495ms\n    [+] Connect-Helper 72ms\nTests completed in 568ms\nPassed: 2 Failed: 0 Skipped: 0 Pending: 0 Inconclusive: 0\n")),(0,n.kt)("h3",{id:"http-\u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c"},"HTTP \u30ea\u30af\u30a8\u30b9\u30c8\u306e\u767a\u884c"),(0,n.kt)("h4",{id:"microsoft-graph-api-\u306e\u547c\u3073\u51fa\u3057\u4f8b"},"Microsoft Graph API \u306e\u547c\u3073\u51fa\u3057\u4f8b"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell",metastring:'title="httpRequest.ps1"',title:'"httpRequest.ps1"'},'param (\n    [parameter(mandatory=$true)][string]$TenantId,\n    [parameter(mandatory=$true)][string]$ClientId,\n    [parameter(mandatory=$true)][string]$ClientSecret,\n    [parameter(mandatory=$true)][string]$Csv)\n\n# -- Token \u3092\u53d6\u5f97\u3059\u308b --\n$token = Invoke-RestMethod -Method Post -Uri "https://login.microsoftonline.com/$tenantId/oauth2/v2.0/token" -Body @{client_id="$clientId";scope="https://graph.microsoft.com/.default";client_secret="$clientSecret";grant_type="client_credentials"} -ContentType \'application/x-www-form-urlencoded\'\n$accessToken = $token.access_token\n')),(0,n.kt)("h4",{id:"\u5b9f\u884c\u4f8b"},"\u5b9f\u884c\u4f8b"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-powershell"},"./httpRequest.ps1 -TenantId 789 -ClientId 566 -ClientSecret 444 \n")))}c.isMDXComponent=!0}}]);